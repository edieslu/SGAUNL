<?xml version="1.0" encoding="UTF-8"?>
<!--
To change this template, choose Tools | Templates
and open the template in the editor.
-->
<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:ui="http://java.sun.com/jsf/facelets"
      xmlns:h="http://java.sun.com/jsf/html"
      xmlns:f="http://java.sun.com/jsf/core"
      xmlns:p="http://primefaces.org/ui">

    <f:metadata>
        <f:viewParam name="usuarioId" value="#{usuarioController.usuarioId}"/>
    </f:metadata>
    <ui:composition template="/templates/plantilla.xhtml">
        <ui:define name="title">
            <h:outputText value=""/>
        </ui:define>
        <ui:define name="content">


            <script type="text/javascript">        
                
                $j(document).ready(function(){
                    $j('.numeros').numeric();
                    $j('.letras').alpha({allow:" "});
                    $j('.mayusculas').val().toUpperCase();
                    $j('.email').alphanumeric({allow:"._-@"});
                    
                });
                
                $j(document).ready(function(){
                    $j('.mayúsculas').val().toUpperCase();
                    
                });
            </script>

            <p:ajaxStatus style="width:16px;height:16px;" id="ajaxStatusPanel">
                <f:facet name="start">
                    <h:graphicImage library="img" name="ajaxloading.gif" />
                </f:facet>
                <f:facet name="complete">
                    <h:outputText value="" />
                </f:facet>
            </p:ajaxStatus>
            <h:form id="formUsuario" prependId="false">
                
                <p:messages closable="true" globalOnly="true"/>
                <p:panel id="editPanelUsuario"
                         header="#{usuarioController.current.id != null ? bundle['header.editar'] : bundle['header.nuevo']}" >
                    
                    <p:accordionPanel id="idAcordion" dynamic="true" cache="true" >

                        <p:tab id="idTabLogin" title="Datos de Login de Usuario" >
                            <h:panelGrid columns="2">
                                <h:outputLabel value="#{bundle['usuarioController.login']}:"/>
                                <p:inputText value="#{usuarioController.current.login}"
                                             label="#{bundle['usuarioController.login']}"
                                             title="#{bundle['usuarioController.login']}"/>
                                <h:outputLabel value="#{bundle['usuarioController.clave']}:"/>
                                <p:password value="#{usuarioController.current.clave}" 
                                            title="#{bundle['usuarioController.clave']}"
                                            label="#{bundle['usuarioController.clave']}">
                                </p:password>
                                <h:outputLabel value="#{bundle['usuarioController.estado']}:"/>
                                <p:selectBooleanCheckbox value="#{usuarioController.current.estado}"
                                                         label="#{bundle['usuarioController.estado']}"/>
                                <h:outputText value="#{bundle['usuarioController.tipoUsuario']}:*"/>
                                <p:selectOneMenu value="#{usuarioController.current.tipoUsuario}" 
                                                 effect="fade" required="true"
                                                 immediate="true" converter="genericConverter"
                                                 valueChangeListener="#{usuarioController.renderTabs}">
                                    <f:selectItem itemLabel="#{bundle['item']}" itemValue=""/>
                                    <f:selectItems value="#{tipoUsuarioController.itemsAvailableSelectOne}"
                                                   />  
                                    <p:ajax update="@form"/>
                                </p:selectOneMenu>
                            </h:panelGrid>
                        </p:tab>

                        <p:tab id="idTabPersonales" title="Datos Personales" rendered="false">  
                           <h:panelGrid columns="4">
                                <h:outputLabel value="#{bundle['usuarioController.dni']}:" for="dni" />
                                <p:inputText id="dni" value="#{usuarioController.current.dni}" 
                                             title="#{bundle['usuarioController.dni']}"
                                             styleClass="numeros"
                                             label="#{bundle['usuarioController.dni']}" maxlength="10"
                                             validator="#{validadorController.validaNumeroCedula}"/>

                                <h:outputLabel value="#{bundle['usuarioController.libretaMilitar']}:" 
                                               for="libretaMilitar" />
                                <p:inputText id="libretaMilitar" 
                                             value="#{usuarioController.current.libretaMilitar}"
                                             title="#{bundle['usuarioController.libretaMilitar']}" 
                                             label="#{bundle['usuarioController.libretaMilitar']}"/>

                                <h:outputLabel value="#{bundle['usuarioController.nombres']}:*" 
                                               for="nombres" />
                                <p:inputText id="nombres" 
                                             value="#{usuarioController.current.nombres}"                                              
                                             title="#{bundle['usuarioController.nombres']}"
                                             styleClass="letras"
                                             required="true"
                                             label="#{bundle['usuarioController.nombres']}"/>

                                <h:outputLabel value="#{bundle['usuarioController.apellidos']}:*" 
                                               for="apellidos" />
                                <p:inputText id="apellidos" 
                                             value="#{usuarioController.current.apellidos}" 
                                             title="#{bundle['usuarioController.apellidos']}" 
                                             label="#{bundle['usuarioController.apellidos']}"
                                             styleClass="letras"
                                             required="true"/>

                                <h:outputLabel id="sexo" value="#{bundle['usuarioController.sexo']}:*"/>
                                <p:selectOneMenu id="_typeSexo" 
                                                 value="#{usuarioController.current.sexo}" 
                                                 effect="fade" 
                                                 label="#{bundle['usuarioController.sexo']}"
                                                 required="true">
                                    <f:selectItem itemLabel="#{bundle['item']}" itemValue=""/>
                                    <f:selectItems value="#{typeListController.typeListSexo}"/>  
                                </p:selectOneMenu>

                                <h:outputLabel value="#{bundle['usuarioController.fechaNacimiento']}:*" for="fechaNacimiento" />
                                <p:calendar id="fechaNacimiento" 
                                            value="#{usuarioController.current.fechaNacimiento}" 
                                            navigator="true" showOn="button" required="true"
                                            label="#{bundle['usuarioController.fechaNacimiento']}"
                                            title="#{bundle['usuarioController.fechaNacimiento']}" 
                                            pattern="dd/MM/yyyy" 
                                            validator="#{validadorController.validarFecha}"/>

                                <h:outputLabel value="#{bundle['usuarioController.ciudadNacimiento']}:" for="ciudadNacimiento" />
                                <p:inputText id="ciudadNacimiento" 
                                             value="#{usuarioController.current.ficha.fichaPersonal.ciudadNacimiento}" 
                                             title="#{bundle['usuarioController.ciudadNacimiento']}" 
                                             styleClass="letras" 
                                             label="#{bundle['usuarioController.ciudadNacimiento']}"/>

                                <h:outputLabel value="#{bundle['usuarioController.cantonNacimiento']}:" for="cantonNacimiento" />
                                <p:inputText id="cantonNacimiento" 
                                             value="#{usuarioController.current.ficha.fichaPersonal.cantonNaciemiento}" 
                                             title="#{bundle['usuarioController.cantonNacimiento']}" 
                                             styleClass="letras"
                                             label="#{bundle['usuarioController.cantonNacimiento']}"/>

                                <h:outputLabel value="#{bundle['usuarioController.provinciaNacimiento']}:" for="provinciaNacimiento" />
                                <p:inputText id="provinciaNacimiento" 
                                             value="#{usuarioController.current.ficha.fichaPersonal.provinciaNacimiento}" 
                                             title="#{bundle['usuarioController.provinciaNacimiento']}" 
                                             styleClass="letras"
                                             label="#{
                                             bundle['usuarioController.provinciaNacimiento']}"/>

                                <h:outputLabel value="#{bundle['usuarioController.direccion']}:" for="direccion" />
                                <p:inputText id="direccion" 
                                             value="#{usuarioController.current.ficha.fichaPersonal.direccion}" 
                                             title="#{bundle['usuarioController.direccion']}" 
                                             styleClass="letras"
                                             label="#{bundle['usuarioController.direccion']}"/>

                                <h:outputLabel value="#{bundle['usuarioController.telefono']}:" for="telefono" />
                                <p:inputText id="telefono" 
                                             value="#{usuarioController.current.ficha.fichaPersonal.telefono}" 
                                             title="#{bundle['usuarioController.telefono']}" 
                                             label="#{bundle['usuarioController.telefono']}"
                                             styleClass="numeros"/>

                                <h:outputLabel value="#{bundle['usuarioController.celular']}:" for="celular" />
                                <p:inputText id="celular" 
                                             value="#{usuarioController.current.ficha.fichaPersonal.celular}" 
                                             title="#{bundle['usuarioController.celular']}" 
                                             label="#{bundle['usuarioController.celular']}"
                                             styleClass="numeros"
                                             maxlength="10"/>

                                <h:outputLabel value="#{bundle['usuarioController.email']}:" for="email" />
                                <p:inputText id="email" 
                                             value="#{usuarioController.current.ficha.fichaPersonal.email}" 
                                             label="#{bundle['usuarioController.email']}"
                                             title="#{bundle['usuarioController.email']}" 
                                             validatorMessage="El email ingresado no es válido"
                                             styleClass="email">
                                    <f:validateRegex pattern="[\w\.-]*[a-zA-Z0-9_]@[\w\.-]*[a-zA-Z0-9]\.[a-zA-Z][a-zA-Z\.]*[a-zA-Z]"/>

                                </p:inputText>

                                <h:outputLabel value="#{bundle['usuarioController.nacionalidad']}:" for="nacionalidad" />
                                <p:inputText id="nacionalidad" 
                                             value="#{usuarioController.current.ficha.fichaPersonal.nacionalidad}" 
                                             title="#{bundle['usuarioController.nacionalidad']}" 
                                             styleClass="letras" 
                                             label="#{bundle['usuarioController.nacionalidad']}"/>

                                <h:outputLabel value="#{bundle['usuarioController.foto']}:" for="foto" />
                                <p:inputText id="foto" value="#{usuarioController.current.ficha.fichaPersonal.foto}" 
                                             title="#{bundle['usuarioController.foto']}" 
                                             label="#{bundle['usuarioController.foto']}"/>

                            </h:panelGrid>
                        </p:tab>

                        <p:tab id="idTabMedicos" title="Datos Medicos" rendered="false">
                            <h:panelGrid columns="4">
                                <h:outputLabel value="#{bundle['usuarioController.tipoSangre']}:*" />
                                <p:selectOneMenu id="_typeSangre" required="true" effect="fade"
                                                 value="#{usuarioController.current.ficha.fichaMedica.tipoSangre}">

                                    <f:selectItem itemLabel="#{bundle['item']}" itemValue=""/>
                                    <f:selectItems value="#{typeListController.typeListSangre}" />  
                                </p:selectOneMenu>

                                <h:outputLabel value="#{bundle['usuarioController.alergias']}:" for="alergias" />
                                <p:inputText id="alergias" 
                                             value="#{usuarioController.current.ficha.fichaMedica.alergias}" 
                                             title="#{bundle['usuarioController.alergias']}" 
                                             label="#{bundle['usuarioController.alergias']}"/>

                                <h:outputLabel value="#{bundle['usuarioController.hospital']}:" for="hospital" />
                                <p:inputText id="hospital" 
                                             value="#{usuarioController.current.ficha.fichaMedica.hospital}" 
                                             title="#{bundle['usuarioController.hospital']}" 
                                             label="#{bundle['usuarioController.hospital']}"/>

                                <h:outputLabel value="#{bundle['usuarioController.telefonoHospital']}:" for="telefonoHosp" />
                                <p:inputText id="telefonoHosp" 
                                             value="#{usuarioController.current.ficha.fichaMedica.telefonoHospital}" 
                                             title="#{bundle['usuarioController.telefonoHospital']}" 
                                             label="#{bundle['usuarioController.telefonoHospital']}"/>

                                <h:outputLabel value="#{bundle['usuarioController.observaciones']}:" for="observaciones" />
                                <p:inputTextarea id="observaciones" 
                                                 value="#{usuarioController.current.ficha.fichaMedica.observaciones}" 
                                                 title="#{bundle['usuarioController.observaciones']}"
                                                 label="#{bundle['usuarioController.observaciones']}"/>

                            </h:panelGrid>
                        </p:tab>
                        <p:tab id="idTabEconomicos" title="Datos Socio-Economicos" rendered="false">
                            <h:panelGrid columns="4">
                                <h:outputLabel value="#{bundle['usuarioController.internet']}:" for="internet" />
                                <p:selectBooleanCheckbox id="internet" 
                                                         label="#{bundle['usuarioController.internet']}" 
                                                         value="#{usuarioController.current.ficha.fichaSocio.internet}"
                                                         /> 

                                <h:outputLabel value="#{bundle['usuarioController.viveCon']}:" for="viveCon" />
                                <p:inputText id="viveCon" 
                                             value="#{usuarioController.current.ficha.fichaSocio.viveCon}" 
                                             title="#{bundle['usuarioController.viveCon']}" 
                                             label="#{bundle['usuarioController.viveCon']}"/>
                            </h:panelGrid>
                        </p:tab>


                    </p:accordionPanel>
                </p:panel>

                <p:commandButton id="idguardar" value="#{bundle['boton.guardar']}"
                                 action="#{usuarioController.persist()}" 
                                 rendered="#{usuarioController.current.id == null}" 
                                 update="editPanelUsuario" icon="#{bundle['icono.guardar']}"/>

                <p:commandButton value="#{bundle['boton.actualizar']}" 
                                 action="#{usuarioController.update()}" 
                                 rendered="#{usuarioController.current.id != null}" 
                                 update="editPanelUsuario" 
                                 icon="#{bundle['icono.actualizar']}"
                                 />
                <p:commandButton value="#{bundle['boton.cancelar']}" 
                                 action="#{usuarioController.cancelEdit()}" 
                                 immediate="true" icon="#{bundle['icono.cancelar']}"/>

            </h:form>
        </ui:define>
    </ui:composition>
</html>